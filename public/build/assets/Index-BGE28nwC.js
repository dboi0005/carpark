import{_ as U,x as O,j as h,q as g,u as H,z as l,g as G,o as R,a as e,b as o,w as s,f as n,t as w,d,c as J,i as L,F as X,J as Q,A as Z}from"./app-NUBUC0vD.js";import{H as $}from"./html5-qrcode-scanner-BZty-w_P.js";import{d as K}from"./dayjs.min-Do_9EaZr.js";const W={class:"d-flex align-center"},tt={class:"form-header pa-6 pb-4"},et={class:"d-flex align-center justify-space-between"},st={class:"d-flex align-center"},ot={class:"text-body-2"},nt={class:"font-weight-bold text-indigo-darken-4"},lt={class:"text-caption text-medium-emphasis mt-2"},at={class:"parkout-wrapper"},it={class:"status-section pa-8 text-center"},rt={class:"icon-wrapper mb-6"},dt={class:"instructions-section mb-6"},ut={class:"text-h6 font-weight-bold text-indigo-darken-4 mb-2"},ct={class:"input-section mb-6"},mt={class:"text-caption text-medium-emphasis text-center mt-2"},pt={class:"action-buttons"},ft={class:"divider-section mb-4"},_t={class:"stats-footer pa-4"},vt={class:"d-flex align-center justify-space-between"},gt={class:"d-flex align-center"},bt={class:"text-subtitle-2 font-weight-bold mb-0"},xt={class:"d-flex align-center"},kt={class:"text-subtitle-2 font-weight-bold mb-0"},wt={class:"pa-4"},yt={class:"d-flex align-center mb-3"},Ct={__name:"Index",setup(zt){const y=O();h(()=>y.props.ticket||null),h(()=>y.props.success||!1),g(null),g([]);const _=g(!1),p=g(null),c=K(),r=H({plate_no:"",park_out_year:c.year(),park_out_month:c.month()+1,park_out_day:c.date(),park_out_hour:c.hour(),park_out_minute:c.minute(),park_out_second:c.second()}),T=()=>{r.post(Q("parkout.submit"),{onSuccess:()=>r.reset(),onError:i=>{i.plate_no}})},I=async()=>{_.value=!0,setTimeout(q,300)},q=async()=>{if(_.value)try{p.value=new $("reader"),await p.value.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},async i=>{console.log("QR code detected âœ…",i),await C(),Z.post(Q("parkout.submit"),{qr_code:i,is_scan_qr:!0})})}catch(i){console.error("Error starting camera:",i.message)}},C=async()=>{if(p.value){try{await p.value.stop(),await p.value.clear()}catch(i){console.error("Error closing scanner:",i)}p.value=null}_.value=!1};return(i,t)=>{const a=l("v-icon"),B=l("v-card-title"),m=l("v-divider"),z=l("v-card-text"),V=l("v-spacer"),f=l("v-btn"),S=l("v-card-actions"),b=l("v-card"),E=l("v-dialog"),v=l("v-avatar"),M=l("v-alert"),N=l("v-chip"),P=l("v-fade-transition"),j=l("v-text-field"),x=l("v-list-item-title"),k=l("v-list-item"),A=l("v-list"),D=l("v-col"),Y=l("v-row"),F=l("v-container");return R(),G(X,null,[e(E,{modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=u=>_.value=u),"max-width":"600"},{default:s(()=>[e(b,{rounded:"lg"},{default:s(()=>[e(B,{class:"pa-6 pb-4"},{default:s(()=>[o("div",W,[e(a,{size:"28",color:"indigo-darken-4",class:"mr-3"},{default:s(()=>[...t[4]||(t[4]=[n("mdi-qrcode-scan",-1)])]),_:1}),t[5]||(t[5]=o("span",{class:"text-h6 font-weight-bold"},"Scan QR Code",-1))])]),_:1}),e(m),e(z,{class:"pa-6"},{default:s(()=>[...t[6]||(t[6]=[o("div",{id:"reader",style:{width:"100%",height:"400px","border-radius":"12px",overflow:"hidden"}},null,-1)])]),_:1}),e(m),e(S,{class:"pa-4"},{default:s(()=>[e(V),e(f,{color:"error",variant:"outlined",onClick:C},{default:s(()=>[e(a,{start:""},{default:s(()=>[...t[7]||(t[7]=[n("mdi-close",-1)])]),_:1}),t[8]||(t[8]=n(" Close ",-1))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(E,{modelValue:i.showConfirmDialog,"onUpdate:modelValue":t[1]||(t[1]=u=>i.showConfirmDialog=u),"max-width":"500",persistent:""},{default:s(()=>[e(b,{rounded:"lg",class:"confirm-card"},{default:s(()=>[o("div",tt,[o("div",et,[o("div",st,[e(v,{color:"indigo-darken-4",size:"48",class:"mr-3"},{default:s(()=>[e(a,{size:"28",color:"white"},{default:s(()=>[...t[9]||(t[9]=[n("mdi-check-decagram",-1)])]),_:1})]),_:1}),t[10]||(t[10]=o("div",null,[o("h2",{class:"text-h6 font-weight-bold text-indigo-darken-4"}," Confirm Sale "),o("p",{class:"text-caption text-medium-emphasis mb-0"}," Mark card as sold in the system ")],-1))]),e(f,{icon:"mdi-close",variant:"text",onClick:i.cancelConfirm},null,8,["onClick"])])]),e(m),e(z,{class:"pa-6"},{default:s(()=>[e(M,{type:"info",variant:"tonal",density:"comfortable",class:"sale-alert mb-0"},{default:s(()=>{var u;return[o("div",ot,[t[11]||(t[11]=n(" You are about to mark card ",-1)),o("span",nt,w((u=i.selectedCardToConfirm)==null?void 0:u.card_number),1),t[12]||(t[12]=n(" as ",-1)),t[13]||(t[13]=o("span",{class:"font-weight-bold"},"CONFIRMED",-1)),t[14]||(t[14]=n(". ",-1))]),o("div",lt,[e(a,{size:"16",class:"mr-1"},{default:s(()=>[...t[15]||(t[15]=[n("mdi-information-outline",-1)])]),_:1}),t[16]||(t[16]=n(" This action will update the card's status permanently. ",-1))])]}),_:1})]),_:1}),e(m),e(S,{class:"pa-6"},{default:s(()=>[e(V),e(f,{variant:"outlined",size:"large",onClick:i.cancelConfirm,"prepend-icon":"mdi-close"},{default:s(()=>[...t[17]||(t[17]=[n(" Cancel ",-1)])]),_:1},8,["onClick"]),e(f,{color:"indigo-darken-4",variant:"flat",size:"large",onClick:i.confirmStatusChange,"prepend-icon":"mdi-check-circle"},{default:s(()=>[...t[18]||(t[18]=[n(" Confirm Sale ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o("div",at,[e(F,{fluid:"",class:"fill-height"},{default:s(()=>[e(Y,{justify:"center",align:"center",class:"fill-height"},{default:s(()=>[e(D,{cols:"12",md:"8",lg:"6"},{default:s(()=>[o("div",it,[e(N,{color:"error",variant:"flat",size:"large",class:"mb-4 status-chip"},{default:s(()=>[e(a,{start:""},{default:s(()=>[...t[19]||(t[19]=[n("mdi-car-arrow-left",-1)])]),_:1}),t[20]||(t[20]=n(" EXIT PROCESSING ",-1))]),_:1}),o("div",rt,[e(v,{color:"error",size:"100",class:"exit-avatar"},{default:s(()=>[e(a,{size:"60",color:"white"},{default:s(()=>[...t[21]||(t[21]=[n("mdi-car-arrow-left",-1)])]),_:1})]),_:1})]),o("div",dt,[o("h3",ut,[e(a,{class:"mr-2"},{default:s(()=>[...t[22]||(t[22]=[n("mdi-information-outline",-1)])]),_:1}),t[23]||(t[23]=n(" Vehicle Exit ",-1))]),t[24]||(t[24]=o("p",{class:"text-body-2 text-medium-emphasis"}," Enter the vehicle plate number or scan the parking ticket to process exit ",-1))]),o("div",ct,[e(j,{modelValue:d(r).plate_no,"onUpdate:modelValue":t[2]||(t[2]=u=>d(r).plate_no=u),placeholder:"ABC1234",variant:"outlined","error-messages":d(r).errors.plate_no,onInput:t[3]||(t[3]=u=>d(r).plate_no=d(r).plate_no.replace(/[^a-zA-Z0-9]/g,"").toUpperCase()),class:"plate-input",density:"comfortable",autofocus:""},{"prepend-inner":s(()=>[e(a,{color:"indigo-darken-4"},{default:s(()=>[...t[25]||(t[25]=[n("mdi-car",-1)])]),_:1})]),"append-inner":s(()=>[e(P,null,{default:s(()=>[d(r).plate_no&&!d(r).errors.plate_no?(R(),J(a,{key:0,color:"success"},{default:s(()=>[...t[26]||(t[26]=[n(" mdi-check-circle ",-1)])]),_:1})):L("",!0)]),_:1})]),_:1},8,["modelValue","error-messages"]),o("div",mt,[e(a,{size:"14",class:"mr-1"},{default:s(()=>[...t[27]||(t[27]=[n("mdi-lightbulb-outline",-1)])]),_:1}),t[28]||(t[28]=n(" Letters and numbers only (e.g., ABC1234) ",-1))])]),o("div",pt,[e(f,{size:"x-large",onClick:T,block:"",color:"indigo-darken-4",disabled:d(r).processing||!d(r).plate_no,loading:d(r).processing,class:"mb-4 action-btn",height:"64"},{default:s(()=>[e(a,{start:"",size:"28"},{default:s(()=>[...t[29]||(t[29]=[n("mdi-exit-run",-1)])]),_:1}),t[30]||(t[30]=o("span",{class:"text-h6 font-weight-bold"},"Process Exit",-1))]),_:1},8,["disabled","loading"]),o("div",ft,[e(m),t[31]||(t[31]=o("span",{class:"divider-text"},"OR",-1)),e(m)]),e(f,{size:"x-large",block:"",color:"indigo-darken-4",variant:"outlined",class:"scan-btn",height:"64",onClick:I},{default:s(()=>[e(a,{start:"",size:"28"},{default:s(()=>[...t[32]||(t[32]=[n("mdi-qrcode-scan",-1)])]),_:1}),t[33]||(t[33]=o("span",{class:"text-h6 font-weight-bold"},"Scan Ticket QR",-1))]),_:1})])]),o("div",_t,[o("div",vt,[o("div",gt,[e(v,{color:"info",size:"32",class:"mr-3"},{default:s(()=>[e(a,{size:"20"},{default:s(()=>[...t[34]||(t[34]=[n("mdi-clock-outline",-1)])]),_:1})]),_:1}),o("div",null,[t[35]||(t[35]=o("p",{class:"text-caption text-medium-emphasis mb-0"},"Current Time",-1)),o("p",bt,w(d(c).format("h:mm A")),1)])]),e(m,{vertical:"",class:"mx-4"}),o("div",xt,[e(v,{color:"warning",size:"32",class:"mr-3"},{default:s(()=>[e(a,{size:"20"},{default:s(()=>[...t[36]||(t[36]=[n("mdi-calendar-today",-1)])]),_:1})]),_:1}),o("div",null,[t[37]||(t[37]=o("p",{class:"text-caption text-medium-emphasis mb-0"},"Today",-1)),o("p",kt,w(d(c).format("MMM D, YYYY")),1)])])])]),e(b,{class:"tips-card elevation-8 mt-6",rounded:"lg"},{default:s(()=>[o("div",wt,[o("div",yt,[e(a,{color:"indigo-darken-4",class:"mr-2"},{default:s(()=>[...t[38]||(t[38]=[n("mdi-help-circle",-1)])]),_:1}),t[39]||(t[39]=o("h4",{class:"text-subtitle-1 font-weight-bold"},"Exit Process Tips",-1))]),e(A,{density:"compact",class:"bg-transparent"},{default:s(()=>[e(k,null,{prepend:s(()=>[e(a,{size:"20",color:"success"},{default:s(()=>[...t[40]||(t[40]=[n("mdi-check-circle",-1)])]),_:1})]),default:s(()=>[e(x,{class:"text-body-2"},{default:s(()=>[...t[41]||(t[41]=[n(" Enter plate number without spaces or dashes ",-1)])]),_:1})]),_:1}),e(k,null,{prepend:s(()=>[e(a,{size:"20",color:"success"},{default:s(()=>[...t[42]||(t[42]=[n("mdi-check-circle",-1)])]),_:1})]),default:s(()=>[e(x,{class:"text-body-2"},{default:s(()=>[...t[43]||(t[43]=[n(" Scan QR code from parking ticket for faster processing ",-1)])]),_:1})]),_:1}),e(k,null,{prepend:s(()=>[e(a,{size:"20",color:"success"},{default:s(()=>[...t[44]||(t[44]=[n("mdi-check-circle",-1)])]),_:1})]),default:s(()=>[e(x,{class:"text-body-2"},{default:s(()=>[...t[45]||(t[45]=[n(" Payment amount will be calculated automatically ",-1)])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})])],64)}}},ht=U(Ct,[["__scopeId","data-v-07566827"]]);export{ht as default};
