import{_ as J,C as K,D as S,q as b,j as U,H as G,I as Q,J as R,z as n,c as P,o as r,w as a,a as s,b as e,f as i,t as d,g as m,F as A,K as L}from"./app-NUBUC0vD.js";import{W as X}from"./utility-C4IXQQAA.js";import{d as Z}from"./dayjs.min-Do_9EaZr.js";const tt={class:"dialog-header"},et={class:"card-info-banner pa-4"},st={class:"d-flex align-center justify-space-between"},at={class:"d-flex align-center"},ot={class:"text-h6 font-weight-bold text-white mb-0"},nt={class:"balance-section pa-6 text-center"},it={class:"pa-4"},lt={class:"text-h4 font-weight-bold text-indigo-darken-4 mb-0"},dt={key:0,class:"text-center py-12"},rt={key:1,class:"text-center py-12"},ct={class:"text-body-2 text-medium-emphasis"},mt={key:2,class:"text-center py-12"},ut={key:3},pt={class:"date-header mb-3"},_t={class:"pa-4"},vt={class:"d-flex align-center justify-space-between"},ft={class:"d-flex align-center flex-grow-1"},gt={class:"d-flex align-center mb-1"},xt={class:"text-subtitle-2 font-weight-bold text-indigo-darken-4"},bt={class:"d-flex align-center"},yt={class:"text-caption text-medium-emphasis"},ht={class:"text-right"},kt={class:"mt-3 d-flex align-center"},wt={class:"text-caption text-medium-emphasis"},zt={__name:"Transactions",props:K({selectedCard:Object},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const _=y,p=S(y,"modelValue"),h=b([]),v=b(!1),f=b(null),k=U(()=>h.value.reduce((l,t)=>{const o=X(t.created_at,"MMMM DD, YYYY");return l[o]||(l[o]=[]),l[o].push(t),l},{})),E=l=>Z(l).format("h:mm A");return G(async()=>{var l,t;v.value=!0;try{const{data:o}=await Q.get(R("transactions",_.selectedCard.id));h.value=o.transactions}catch(o){console.error("❌ Fetch error:",o),f.value=((t=(l=o.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to load transactions"}finally{v.value=!1}}),(l,t)=>{const o=n("v-icon"),H=n("v-toolbar-title"),w=n("v-spacer"),z=n("v-btn"),I=n("v-toolbar"),C=n("v-avatar"),N=n("v-divider"),g=n("v-card"),O=n("v-progress-circular"),x=n("v-chip"),W=n("v-card-text"),$=n("v-card-actions"),q=n("v-dialog");return r(),P(q,{modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=u=>p.value=u),"max-width":"500",persistent:"",scrollable:""},{default:a(()=>[s(g,{rounded:"lg",class:"transactions-dialog"},{default:a(()=>[e("div",tt,[s(I,{flat:"",density:"comfortable",color:"indigo-darken-4"},{default:a(()=>[s(H,{class:"d-flex align-center"},{default:a(()=>[s(o,{class:"mr-2",color:"white"},{default:a(()=>[...t[3]||(t[3]=[i("mdi-history",-1)])]),_:1}),t[4]||(t[4]=e("span",{class:"text-white font-weight-medium"},"Transaction History",-1))]),_:1}),s(w),s(z,{icon:"mdi-close",variant:"text",color:"white",onClick:t[0]||(t[0]=u=>p.value=!1)})]),_:1}),e("div",et,[e("div",st,[e("div",at,[s(C,{color:"white",size:"48",class:"mr-3"},{default:a(()=>[s(o,{size:"28",color:"indigo-darken-4"},{default:a(()=>[...t[5]||(t[5]=[i("mdi-credit-card",-1)])]),_:1})]),_:1}),e("div",null,[t[6]||(t[6]=e("p",{class:"text-caption text-white-70 mb-1"},"Card Number",-1)),e("p",ot,d(_.selectedCard.card_number),1)])])])])]),s(N),e("div",nt,[s(g,{class:"balance-card elevation-0",color:"indigo-lighten-5",rounded:"lg"},{default:a(()=>[e("div",it,[t[7]||(t[7]=e("p",{class:"text-caption text-medium-emphasis mb-2"},"Current Balance",-1)),e("p",lt," ₱"+d(Number(_.selectedCard.balance).toFixed(2)),1)])]),_:1})]),s(W,{class:"transactions-content pa-6 pt-0"},{default:a(()=>[v.value?(r(),m("div",dt,[s(O,{indeterminate:"",color:"indigo-darken-4",size:"64"}),t[8]||(t[8]=e("p",{class:"text-body-2 text-medium-emphasis mt-4"},"Loading transactions...",-1))])):f.value?(r(),m("div",rt,[s(o,{size:"64",color:"error",class:"mb-4"},{default:a(()=>[...t[9]||(t[9]=[i("mdi-alert-circle-outline",-1)])]),_:1}),t[10]||(t[10]=e("p",{class:"text-h6 font-weight-medium mb-2"},"Error Loading Data",-1)),e("p",ct,d(f.value),1)])):Object.keys(k.value).length===0?(r(),m("div",mt,[s(o,{size:"80",color:"grey-lighten-2",class:"mb-4"},{default:a(()=>[...t[11]||(t[11]=[i("mdi-inbox-outline",-1)])]),_:1}),t[12]||(t[12]=e("p",{class:"text-h6 font-weight-medium mb-2"},"No Transactions Yet",-1)),t[13]||(t[13]=e("p",{class:"text-body-2 text-medium-emphasis"},"There are no transaction records for this card.",-1))])):(r(),m("div",ut,[(r(!0),m(A,null,L(k.value,(u,T)=>(r(),m("div",{key:T,class:"day-group mb-6"},[e("div",pt,[s(x,{color:"indigo-lighten-5",variant:"flat",size:"small"},{default:a(()=>[s(o,{start:"",size:"14"},{default:a(()=>[...t[14]||(t[14]=[i("mdi-calendar",-1)])]),_:1}),i(" "+d(T),1)]),_:2},1024)]),(r(!0),m(A,null,L(u,c=>(r(),P(g,{key:c.id,class:"transaction-card elevation-2 mb-3",rounded:"lg"},{default:a(()=>{var V,M,j,B,D;return[e("div",_t,[e("div",vt,[e("div",ft,[s(C,{color:"indigo-lighten-5",size:"48",class:"mr-3"},{default:a(()=>[s(o,{size:"28",color:"indigo-darken-4"},{default:a(()=>[...t[15]||(t[15]=[i("mdi-car",-1)])]),_:1})]),_:1}),e("div",null,[e("div",gt,[t[16]||(t[16]=e("span",{class:"text-caption text-medium-emphasis mr-1"},"Plate:",-1)),e("span",xt,d(((M=(V=c.payment)==null?void 0:V.ticket)==null?void 0:M.plate_no)||"N/A"),1)]),e("div",bt,[t[17]||(t[17]=e("span",{class:"text-caption text-medium-emphasis mr-1"},"Ticket:",-1)),e("span",yt,d(((B=(j=c.payment)==null?void 0:j.ticket)==null?void 0:B.ticket_no)||"N/A"),1)])])]),e("div",ht,[s(x,{color:"error",variant:"flat",size:"small",class:"font-weight-bold"},{default:a(()=>[s(o,{start:"",size:"14"},{default:a(()=>[...t[18]||(t[18]=[i("mdi-minus",-1)])]),_:1}),i(" ₱"+d(Number(c.amount).toFixed(2)),1)]),_:2},1024)])]),e("div",kt,[s(x,{color:((D=c.payment)==null?void 0:D.status)==="Paid"?"success":"warning",variant:"tonal",size:"x-small",class:"mr-2"},{default:a(()=>{var F;return[s(o,{start:"",size:"12"},{default:a(()=>{var Y;return[i(d(((Y=c.payment)==null?void 0:Y.status)==="Paid"?"mdi-check-circle":"mdi-clock-outline"),1)]}),_:2},1024),i(" "+d(((F=c.payment)==null?void 0:F.status)||"Pending"),1)]}),_:2},1032,["color"]),e("span",wt,d(E(c.created_at)),1)])])]}),_:2},1024))),128))]))),128))]))]),_:1}),s(N),s($,{class:"pa-4"},{default:a(()=>[s(w),s(z,{color:"indigo-darken-4",variant:"flat",onClick:t[1]||(t[1]=u=>p.value=!1)},{default:a(()=>[...t[19]||(t[19]=[i(" Close ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Vt=J(zt,[["__scopeId","data-v-b804a0e8"]]);export{Vt as default};
